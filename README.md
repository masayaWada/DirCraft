# DirCraft

作業用フォルダを直感的に作成・整理できるGUIツール

## 概要

DirCraftは、プロジェクトやタスクの開始時に必要なディレクトリ構造を、テンプレートやカスタム設定から素早く生成できるPythonベースのGUIツールです。特に、クラウドインフラストラクチャの変更作業における標準化された作業環境の構築を支援します。

## 機能

### 主要機能

1. **作業用ディレクトリの自動作成**
   - 指定されたディレクトリ内に作業用ディレクトリを自動作成
   - ディレクトリ名は以下の形式で自動生成：
     ```
     変更番号-作成日-チームグループ名-自身の苗字-変更申請書-【対象クラウド】変更対象システム名_作業内容_作業日
     ```

2. **ステータスバーの色分け表示**
   - 処理結果に応じてステータスバーの文字色が変化
   - 成功時：緑文字、エラー時：赤文字、通常時：黒文字

3. **パスをクリップボードにコピー**
   - 作成されたディレクトリのパスをクリップボードにコピーするボタンを提供
   - ディレクトリ作成後にパスを簡単に他のアプリケーションで使用可能

4. **必須手順書の自動配置**
   - 作業用ディレクトリ内に標準的な手順書を自動配置
   - 以下のファイルを雛形からコピー：
     - `手順書/作業前確認手順.xlsm`（必須手順書）
     - `準備調整チェックシート.xlsx`（作業用ディレクトリのルートに配置）
     - `証跡/作業証跡_作業内容_変更対象システム名_作業日.xlsx`
     - 作業内容別の手順書テンプレート（`手順書/`ディレクトリに配置）

5. **作業内容別テンプレート配置**
   - 対象クラウド（AWS、Azure、AWS-Azure）と作業内容の組み合わせに応じた手順書の雛形を特定のディレクトリから作業ディレクトリにコピー
   - 作業内容（IAM改廃、NSG改廃、EC2設定変更など）ごとに異なる内容の手順書を提供
   - 作業内容によっては複数の手順書ファイルが配置される場合がある

## 入力情報

ツールは以下の情報を入力として受け取ります：

- **変更番号**: 例：CHG000000
- **対象クラウド**: 例：AWS、Azure、AWS-Azure
- **作業内容**: 例：IAM改廃、NSG改廃、EC2設定変更
- **作業日**: 作業実施予定日
- **変更対象システム名**: 例：○○システム

## ディレクトリ構造

生成される作業用ディレクトリの構造：

```
指定のディレクトリ/
└── 作業用ディレクトリ/
    ├── 準備調整チェックシート.xlsx
    ├── 手順書/
    │   ├── 作業前確認手順.xlsm
    │   └── [作業内容別テンプレート]
    ├── 証跡/
    │   └── 作業証跡_作業内容_変更対象システム名_作業日.xlsx
    └── メール/
        └── [その他のメール関連ファイル]
```

## 技術仕様

### 使用技術

- **プログラミング言語**: Python 3.x
- **GUIフレームワーク**: tkinter（標準ライブラリ）
- **ファイル操作**: openpyxl（Excelファイル操作）
- **日付処理**: datetime（標準ライブラリ）
- **設定管理**: JSON形式の設定ファイル
- **配布形式**: Nuitkaによる最適化されたexe形式

### システム要件

- Windows 10/11（exe形式での配布）
- 必要なPythonパッケージ（開発時）：
  - openpyxl（Excelファイル操作用）
  - Nuitka（最適化されたexe形式への変換用）

## インストール方法

### exeファイルの作成

- ビルドスクリプトを使用してexeファイルを作成する

**Windows環境:**
```cmd
# バッチファイルを使用
build_nuitka.bat
```

### exe形式での実行（推奨）

1. 配布されたexeファイルをダウンロード
2. 任意のフォルダに配置して実行
3. 初回実行時に`config`フォルダが自動作成される

### 開発環境での実行

1. リポジトリをクローン
   ```bash
   git clone [repository-url]
   cd DirCraft
   ```

2. 必要な依存関係をインストール
   ```bash
   pip install -r requirements.txt
   ```

3. アプリケーションを実行
   ```bash
   python main.py
   ```

### Nuitkaのインストール

Nuitkaを使用してexeファイルを作成する場合：

```bash
# 基本的なインストール
pip install nuitka

# 推奨オプション付きのインストール
pip install "nuitka[full]"

# 開発版のインストール（最新機能を使用する場合）
pip install "nuitka[dev]"
```

## 使用方法

1. アプリケーションを起動
2. 以下の情報を入力：
   - 変更番号
   - 対象クラウド
   - 作業内容
   - 作業日
   - 変更対象システム名
   - 作業用ディレクトリを作成する親ディレクトリのパス
3. 「ディレクトリ作成」ボタンをクリック
4. 指定された場所に作業用ディレクトリが作成され、雛形ファイルが適切な場所にコピーされる
5. 「パスをコピー」ボタンで作成されたディレクトリのパスをクリップボードにコピー可能

## 設定

### テンプレートファイル

- 各クラウド・作業内容の組み合わせに対応した雛形ファイルを`templates/`ディレクトリに配置
- 雛形はExcel形式（.xlsx）で提供
- 作業用ディレクトリ作成時に、これらの雛形ファイルが適切な場所にコピーされる

### カスタマイズ

- 手順書の内容やディレクトリ構造は設定ファイルでカスタマイズ可能
- 新しい雛形の追加も容易
- 設定ファイル（JSON形式）で作業者の苗字、チームグループ名、指定ディレクトリのパスなどを管理
- 手順書の設定では、対象クラウド・作業内容ごとに雛形となる手順書のファイルパスを配列形式で保持
- 共通テンプレート（必須手順書、準備調整チェックシート、証跡）の設定も可能

## 開発者向け情報

### プロジェクト構造

```
DirCraft/
├── main.py              # メインアプリケーション
├── gui/                 # GUI関連モジュール
├── core/                # コアロジック
├── templates/           # 雛形ファイル
├── config/              # 設定ファイル（JSON形式）
├── requirements.txt     # 依存関係
└── README.md           # このファイル
```

### 設定ファイル構成

- **config.json**: 作業者の苗字、チームグループ名、指定ディレクトリのパスなどの基本設定
- **procedures.json**: 対象クラウド・作業内容ごとの雛形手順書ファイルパスと共通テンプレートの設定を管理

### 貢献方法

1. このリポジトリをフォーク
2. 機能ブランチを作成
3. 変更をコミット
4. プルリクエストを作成

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細については[LICENSE](LICENSE)ファイルを参照してください。

MITライセンスにより、以下のことが可能です：

- 商用利用
- 修正・改変
- 配布
- 私的利用

ただし、著作権表示とライセンス表示は保持する必要があります。

## パフォーマンス最適化

### Nuitkaによる最適化の利点

1. **高速起動**
   - PyInstallerと比較して2-3倍高速な起動
   - 一時ディレクトリの作成やファイル抽出が不要
   - ネイティブコードへの最適化

2. **ファイルサイズの削減**
   - 不要なライブラリの除外
   - より効率的な依存関係の解決
   - 最適化されたバイナリ

3. **起動時間の比較**
   - **Nuitka本番版**: 約1-2秒（推奨）
   - **Nuitkaデバッグ版**: 約2-3秒
   - **PyInstaller版**: 約2-5秒（従来）

4. **最適化の特徴**
   - 静的解析による最適化
   - 未使用コードの除去
   - より効率的なメモリ使用

### GUIが表示されない場合

1. **段階的なデバッグ**
   - **デバッグ版**: 詳細な情報付きでビルド：
     ```bash
     python -m nuitka --standalone --onefile --windows-console-mode=force --output-filename=DirCraft_debug.exe main.py
     ```
   - **本番版**: 最適化された設定でビルド：
     ```bash
     python -m nuitka --standalone --onefile --windows-console-mode=hide --output-filename=DirCraft.exe main.py
     ```

2. **エラーメッセージの確認**
   - デバッグ版ではコンソールが表示されるので、エラーメッセージを確認
   - 特に「モジュールの読み込み」で停止している場合は、依存関係の問題の可能性

3. **設定ファイルの確認**
   - `config/`フォルダが存在することを確認
   - `config.json`と`procedures.json`が正しく配置されていることを確認
   - 設定ファイルの内容が正しいJSON形式であることを確認

4. **依存関係の確認**
   - 必要なPythonパッケージがインストールされていることを確認
   - プロジェクトの構造が正しいことを確認
   - 特にtkinterが正しく動作することを確認

5. **環境のクリーンアップ**
   - `dist`フォルダと`build`フォルダを削除
   - `__pycache__`フォルダを削除
   - 仮想環境を使用している場合は、新しい仮想環境で試行

6. **段階的なテスト**
   - まず最小限版で動作確認
   - 問題がなければ、段階的に機能を追加

### アイコンが表示されない場合

1. **アイコンファイルの確認**
   - ICOファイルが有効な形式であることを確認
   - ファイルサイズが適切であることを確認（推奨：256KB以下）

2. **キャッシュのクリア**
   - Windowsのアイコンキャッシュをクリア：
     ```cmd
     ie4uinit.exe -show
     ie4uinit.exe -ClearIconCache
     taskkill /IM explorer.exe /F
     start explorer.exe
     ```

3. **再ビルド**
   - `dist`フォルダを削除してから再ビルド
   - 異なるアイコンファイルで試行

4. **Windowsの設定**
   - タスクバーの設定で「小さいタスクバーボタンを使用する」を無効化
   - アプリケーションを管理者として実行

## サポート

問題や質問がある場合は、【Issue】を作成してください。

## 更新履歴

- **v1.2.0** - Nuitka最適化版
  - PyInstallerからNuitkaへの移行
  - 自動ビルドスクリプトの提供
  - ファイルサイズの削減

- **v1.1.0** - 機能拡張版
  - ステータスバーの色分け表示（成功：緑、エラー：赤、通常：黒）
  - パスをクリップボードにコピーするボタンの追加

- **v1.0.0** - 初回リリース
  - 基本的なディレクトリ作成機能
  - 標準雛形ファイルのコピー機能
  - シンプルなGUIインターフェース
  - JSON形式の設定ファイル管理
  - exe形式での配布対応
